const sqlite3 = require('sqlite3').verbose();
const db = new sqlite3.Database('./calibration.db');

console.log('Updating equipment categories to match service categories...');

db.serialize(() => {
  // Clear existing equipment
  db.run('DELETE FROM equipment', (err) => {
    if (err) {
      console.error('Error clearing equipment:', err);
    } else {
      console.log('✓ Cleared existing equipment');
    }
  });

  // Insert equipment with correct service categories
  const equipment = [
    // Pressure Equipment
    {
      equipment_id: 'PRS-001',
      name: 'Digital Pressure Gauge',
      category: 'Pressure',
      manufacturer: 'Fluke',
      model: '700G29',
      serial_number: 'FL700-001234',
      asset_tag: 'PRS-AST-001',
      location: 'Pressure Lab - Room 101',
      department: 'Pressure Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2023-01-15',
      purchase_cost: 2500.00,
      calibration_interval: 365,
      last_calibration_date: '2024-10-01',
      next_calibration_date: '2025-10-01',
      calibration_status: 'valid',
      traceability_standard: 'NIST Traceable',
      traceability_cert_number: 'NIST-2024-P-12345',
      uncertainty: '±0.025% FS',
      range_min: '0 psi',
      range_max: '10,000 psi',
      resolution: '0.01 psi',
      accuracy: '±0.025% of reading',
      condition: 'excellent',
      notes: 'Primary pressure standard for gauge calibration',
      created_by: 1
    },
    {
      equipment_id: 'PRS-002',
      name: 'Pressure Calibrator',
      category: 'Pressure',
      manufacturer: 'Druck',
      model: 'DPI 620',
      serial_number: 'DK620-002345',
      asset_tag: 'PRS-AST-002',
      location: 'Pressure Lab - Room 101',
      department: 'Pressure Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2022-11-10',
      purchase_cost: 3200.00,
      calibration_interval: 365,
      last_calibration_date: '2024-08-20',
      next_calibration_date: '2025-08-20',
      calibration_status: 'valid',
      traceability_standard: 'NPL Traceable',
      traceability_cert_number: 'NPL-2024-P-456',
      uncertainty: '±0.05% FS',
      range_min: '0 bar',
      range_max: '700 bar',
      resolution: '0.001 bar',
      accuracy: '±0.05% of reading',
      condition: 'good',
      notes: 'Hydraulic and pneumatic pressure calibration',
      created_by: 1
    },
    {
      equipment_id: 'PRS-003',
      name: 'Vacuum Gauge',
      category: 'Pressure',
      manufacturer: 'Inficon',
      model: 'CDG045',
      serial_number: 'INF045-789012',
      asset_tag: 'PRS-AST-003',
      location: 'Pressure Lab - Room 101',
      department: 'Pressure Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2023-05-20',
      purchase_cost: 1800.00,
      calibration_interval: 365,
      last_calibration_date: '2024-03-15',
      next_calibration_date: '2025-03-15',
      calibration_status: 'due_soon',
      traceability_standard: 'NIST Traceable',
      traceability_cert_number: 'NIST-2024-V-789',
      uncertainty: '±0.2% reading',
      range_min: '1e-6 Torr',
      range_max: '1000 Torr',
      resolution: '0.001 Torr',
      accuracy: '±0.2%',
      condition: 'good',
      notes: 'Vacuum pressure measurements',
      created_by: 1
    },

    // Temperature Equipment
    {
      equipment_id: 'TMP-001',
      name: 'Temperature Calibrator',
      category: 'Temperature',
      manufacturer: 'Fluke',
      model: '9142',
      serial_number: 'FK9142-005678',
      asset_tag: 'TMP-AST-001',
      location: 'Temperature Lab - Room 102',
      department: 'Temperature Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2023-03-20',
      purchase_cost: 8500.00,
      calibration_interval: 365,
      last_calibration_date: '2024-09-15',
      next_calibration_date: '2025-09-15',
      calibration_status: 'valid',
      traceability_standard: 'UKAS Traceable',
      traceability_cert_number: 'UKAS-2024-T-789',
      uncertainty: '±0.25°C',
      range_min: '-25°C',
      range_max: '660°C',
      resolution: '0.01°C',
      accuracy: '±0.25°C at 660°C',
      condition: 'excellent',
      notes: 'Dry-block calibrator for thermocouples and RTDs',
      created_by: 1
    },
    {
      equipment_id: 'TMP-002',
      name: 'RTD Reference Standard',
      category: 'Temperature',
      manufacturer: 'Hart Scientific',
      model: '5628',
      serial_number: 'HS5628-123456',
      asset_tag: 'TMP-AST-002',
      location: 'Temperature Lab - Room 102',
      department: 'Temperature Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2022-08-10',
      purchase_cost: 4200.00,
      calibration_interval: 365,
      last_calibration_date: '2024-07-01',
      next_calibration_date: '2025-07-01',
      calibration_status: 'valid',
      traceability_standard: 'NIST Traceable',
      traceability_cert_number: 'NIST-2024-T-456',
      uncertainty: '±0.01°C',
      range_min: '-200°C',
      range_max: '420°C',
      resolution: '0.001°C',
      accuracy: '±0.01°C',
      condition: 'excellent',
      notes: 'High-accuracy RTD reference probe',
      created_by: 1
    },

    // Electrical Equipment
    {
      equipment_id: 'ELC-001',
      name: 'Digital Multimeter',
      category: 'Electrical',
      manufacturer: 'Fluke',
      model: '87V',
      serial_number: 'FL87V-001234',
      asset_tag: 'ELC-AST-001',
      location: 'Electrical Lab - Room 103',
      department: 'Electrical Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2023-01-15',
      purchase_cost: 1500.00,
      calibration_interval: 365,
      last_calibration_date: '2024-10-01',
      next_calibration_date: '2025-10-01',
      calibration_status: 'valid',
      traceability_standard: 'NIST Traceable',
      traceability_cert_number: 'NIST-2024-E-12345',
      uncertainty: '±0.05%',
      range_min: '0 V',
      range_max: '1000 V',
      resolution: '0.1 mV',
      accuracy: '±(0.05% + 2 counts)',
      condition: 'excellent',
      notes: 'Primary reference standard for electrical measurements',
      created_by: 1
    },
    {
      equipment_id: 'ELC-002',
      name: 'Oscilloscope',
      category: 'Electrical',
      manufacturer: 'Tektronix',
      model: 'MSO64',
      serial_number: 'TEK64-123456',
      asset_tag: 'ELC-AST-002',
      location: 'Electrical Lab - Room 103',
      department: 'Electrical Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2024-02-15',
      purchase_cost: 12000.00,
      calibration_interval: 365,
      last_calibration_date: '2024-02-20',
      next_calibration_date: '2025-02-20',
      calibration_status: 'due_soon',
      traceability_standard: 'NIST Traceable',
      traceability_cert_number: 'NIST-2024-E-56789',
      uncertainty: '±2%',
      range_min: '0 Hz',
      range_max: '1 GHz',
      resolution: '1 MHz',
      accuracy: '±2%',
      condition: 'excellent',
      notes: 'High-frequency signal analysis and calibration',
      created_by: 1
    },
    {
      equipment_id: 'ELC-003',
      name: 'Power Meter',
      category: 'Electrical',
      manufacturer: 'Yokogawa',
      model: 'WT1800E',
      serial_number: 'YKW1800-445566',
      asset_tag: 'ELC-AST-003',
      location: 'Electrical Lab - Room 103',
      department: 'Electrical Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2022-09-05',
      purchase_cost: 8900.00,
      calibration_interval: 365,
      last_calibration_date: '2023-10-10',
      next_calibration_date: '2024-10-10',
      calibration_status: 'overdue',
      traceability_standard: 'UKAS Traceable',
      traceability_cert_number: 'UKAS-2023-E-789',
      uncertainty: '±0.02%',
      range_min: '0 W',
      range_max: '10 kW',
      resolution: '0.1 W',
      accuracy: '±0.02%',
      condition: 'good',
      notes: 'URGENT: Calibration overdue - schedule immediately',
      created_by: 1
    },

    // Mechanical Equipment
    {
      equipment_id: 'MCH-001',
      name: 'Torque Calibrator',
      category: 'Mechanical',
      manufacturer: 'Norbar',
      model: 'TruCheck',
      serial_number: 'NB-TC-778899',
      asset_tag: 'MCH-AST-001',
      location: 'Mechanical Lab - Room 104',
      department: 'Mechanical Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2023-06-12',
      purchase_cost: 3500.00,
      calibration_interval: 365,
      last_calibration_date: '2024-09-01',
      next_calibration_date: '2025-09-01',
      calibration_status: 'valid',
      traceability_standard: 'UKAS Traceable',
      traceability_cert_number: 'UKAS-2024-M-123',
      uncertainty: '±0.25% FS',
      range_min: '0 Nm',
      range_max: '1500 Nm',
      resolution: '0.1 Nm',
      accuracy: '±0.25%',
      condition: 'excellent',
      notes: 'Torque wrench and tool calibration',
      created_by: 1
    },
    {
      equipment_id: 'MCH-002',
      name: 'Digital Scale',
      category: 'Mechanical',
      manufacturer: 'Mettler Toledo',
      model: 'XPE205',
      serial_number: 'MT205-009876',
      asset_tag: 'MCH-AST-002',
      location: 'Mechanical Lab - Room 104',
      department: 'Mechanical Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2023-06-05',
      purchase_cost: 4500.00,
      calibration_interval: 180,
      last_calibration_date: '2024-09-01',
      next_calibration_date: '2025-03-01',
      calibration_status: 'valid',
      traceability_standard: 'OIML Traceable',
      traceability_cert_number: 'OIML-2024-M-456',
      uncertainty: '±0.015 mg',
      range_min: '0 g',
      range_max: '220 g',
      resolution: '0.01 mg',
      accuracy: '±0.015 mg',
      condition: 'excellent',
      notes: 'Micro-balance for precise mass measurements',
      created_by: 1
    },

    // Dimensional Equipment
    {
      equipment_id: 'DIM-001',
      name: 'Digital Caliper Reference',
      category: 'Dimensional',
      manufacturer: 'Mitutoyo',
      model: '500-196-30',
      serial_number: 'MIT500-334455',
      asset_tag: 'DIM-AST-001',
      location: 'Dimensional Lab - Room 105',
      department: 'Dimensional Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2023-04-10',
      purchase_cost: 850.00,
      calibration_interval: 365,
      last_calibration_date: '2024-08-15',
      next_calibration_date: '2025-08-15',
      calibration_status: 'valid',
      traceability_standard: 'NIST Traceable',
      traceability_cert_number: 'NIST-2024-D-123',
      uncertainty: '±0.02 mm',
      range_min: '0 mm',
      range_max: '300 mm',
      resolution: '0.01 mm',
      accuracy: '±0.02 mm',
      condition: 'good',
      notes: 'Reference standard for caliper calibration',
      created_by: 1
    },
    {
      equipment_id: 'DIM-002',
      name: 'Gage Block Set',
      category: 'Dimensional',
      manufacturer: 'Mitutoyo',
      model: '516-942-10',
      serial_number: 'MIT516-556677',
      asset_tag: 'DIM-AST-002',
      location: 'Dimensional Lab - Room 105',
      department: 'Dimensional Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2022-07-20',
      purchase_cost: 2100.00,
      calibration_interval: 730,
      last_calibration_date: '2023-06-01',
      next_calibration_date: '2025-06-01',
      calibration_status: 'valid',
      traceability_standard: 'NIST Traceable',
      traceability_cert_number: 'NIST-2023-D-789',
      uncertainty: '±0.05 μm',
      range_min: '0.5 mm',
      range_max: '100 mm',
      resolution: '0.001 mm',
      accuracy: 'Grade 0',
      condition: 'excellent',
      notes: 'Master gage block set - Grade 0',
      created_by: 1
    },
    {
      equipment_id: 'DIM-003',
      name: 'Micrometer Standard',
      category: 'Dimensional',
      manufacturer: 'Starrett',
      model: '734XFL',
      serial_number: 'STR734-112233',
      asset_tag: 'DIM-AST-003',
      location: 'Dimensional Lab - Room 105',
      department: 'Dimensional Testing',
      responsible_person: 'E. Mensah',
      purchase_date: '2023-02-15',
      purchase_cost: 680.00,
      calibration_interval: 365,
      last_calibration_date: '2024-01-10',
      next_calibration_date: '2025-01-10',
      calibration_status: 'due_soon',
      traceability_standard: 'NIST Traceable',
      traceability_cert_number: 'NIST-2024-D-345',
      uncertainty: '±0.002 mm',
      range_min: '0 mm',
      range_max: '25 mm',
      resolution: '0.001 mm',
      accuracy: '±0.002 mm',
      condition: 'good',
      notes: 'Reference micrometer for calibration work',
      created_by: 1
    }
  ];

  const stmt = db.prepare(`
    INSERT INTO equipment (
      equipment_id, name, category, manufacturer, model, serial_number,
      asset_tag, location, department, responsible_person, purchase_date,
      purchase_cost, calibration_interval, last_calibration_date, next_calibration_date,
      calibration_status, traceability_standard, traceability_cert_number,
      uncertainty, range_min, range_max, resolution, accuracy, condition, notes, created_by
    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
  `);

  equipment.forEach(equip => {
    stmt.run(
      equip.equipment_id, equip.name, equip.category, equip.manufacturer,
      equip.model, equip.serial_number, equip.asset_tag, equip.location,
      equip.department, equip.responsible_person, equip.purchase_date,
      equip.purchase_cost, equip.calibration_interval, equip.last_calibration_date,
      equip.next_calibration_date, equip.calibration_status, equip.traceability_standard,
      equip.traceability_cert_number, equip.uncertainty, equip.range_min,
      equip.range_max, equip.resolution, equip.accuracy, equip.condition,
      equip.notes, equip.created_by
    );
  });

  stmt.finalize((err) => {
    if (err) {
      console.error('Error inserting equipment:', err);
    } else {
      console.log('✓ Equipment added with service categories:');
      console.log('  - Pressure: 3 items');
      console.log('  - Temperature: 2 items');
      console.log('  - Electrical: 3 items');
      console.log('  - Mechanical: 2 items');
      console.log('  - Dimensional: 3 items');
    }
    
    db.close(() => {
      console.log('\n✅ Equipment categories updated successfully!');
    });
  });
});
